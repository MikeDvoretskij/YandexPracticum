<section class="theory-viewer__blocking-layout-block theory-viewer__block theory-viewer__block_type_vertical-layout theory-viewer__block_layout"><section class="theory-viewer__block theory-viewer__block_type_markdown"><div class="Markdown base-markdown base-markdown_with-gallery markdown markdown_size_normal markdown_type_theory full-markdown"><h1>Описание проекта</h1><h1>Поиск по изображениям</h1><div class="paragraph">Поздравляем! Вы прошли курс в тренажёре. Самое время проверить знания и решить новую задачу. Выполнять работу вы будете самостоятельно.</div><div class="paragraph">Когда закончите, отправьте её на проверку ревьюеру: он пришлёт комментарии в течение суток. После этого нужно доработать проект и пройти повторную проверку, если это будет необходимо.</div><div class="paragraph">Скорее всего, вы будете дорабатывать кейс по комментариям ещё несколько раз. Это нормально.</div><div class="paragraph">Проект завершён, когда ревьюер одобрил все доработки.</div><h1>Описание проекта</h1><div class="paragraph">Вы работаете в фотохостинге для профессиональных фотографов «Со Смыслом» (“With Sense”). </div><div class="paragraph">Ваши пользователи размещают свои фотографии на хостинге и сопровождают их полным описанием: указывают место съёмок, модель камеры и т. д. Отличительная особенность сервиса — описание: его может предоставить не только тот, кто размещает фотографию, но и другие пользователи портала. Например, для этой фотографии</div><div class="paragraph"><div class="downloadable-image"><a class="downloadable-image__button" download="Image.png"><svg class="icon icon-arrows-24-download downloadable-image__icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3C11.45 3 11 3.45 11 4V10.9219C11 11.6763 11.0854 12.4276 11.254 13.1613L11.0483 13.3684L10.8331 13.0242C10.4323 12.3835 9.96022 11.7902 9.42583 11.2558L8.46 10.29C8.07 9.89999 7.44 9.89999 7.05 10.29C6.66 10.68 6.66 11.32 7.05 11.71L10.9404 15.5926C11.526 16.1769 12.474 16.1769 13.0596 15.5926L16.95 11.71C17.34 11.32 17.34 10.68 16.95 10.29C16.56 9.89999 15.93 9.89999 15.54 10.29L14.5742 11.2558C14.0398 11.7902 13.5677 12.3835 13.1669 13.0242L12.9517 13.3684L12.746 13.1613C12.9146 12.4276 13 11.6763 13 10.9219V4C13 3.45 12.55 3 12 3ZM7 19C6.44772 19 6 19.4477 6 20C6 20.5523 6.44772 21 7 21H17C17.5523 21 18 20.5523 18 20C18 19.4477 17.5523 19 17 19H7Z" fill="currentColor" fill-opacity="0.85"></path></svg></a><img src="https://pictures.s3.yandex.net:443/resources/54501196_a9ac9d66f2_1661350725.jpg" alt="image" crossorigin="anonymous" class="image image_expandable"></div></div><div class="paragraph">описание выглядит так:</div><div class="paragraph">⎢ A hiker poses for a picture in front of stunning mountains and clouds. </div><div class="paragraph">Ваш отдел занимается экспериментом по разработке поиска референсных фотографий для фотографов. Суть поиска заключается в следующем: пользователь сервиса вводит описание нужной сцены. Например, такое:</div><div class="paragraph">⎢ A man is crossing a mountain pass on a metal bridge.</div><div class="paragraph">Сервис выводит несколько фотографий с такой же или похожей сценой.</div><div class="paragraph"><div class="downloadable-image"><a class="downloadable-image__button" download="Image.png"><svg class="icon icon-arrows-24-download downloadable-image__icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3C11.45 3 11 3.45 11 4V10.9219C11 11.6763 11.0854 12.4276 11.254 13.1613L11.0483 13.3684L10.8331 13.0242C10.4323 12.3835 9.96022 11.7902 9.42583 11.2558L8.46 10.29C8.07 9.89999 7.44 9.89999 7.05 10.29C6.66 10.68 6.66 11.32 7.05 11.71L10.9404 15.5926C11.526 16.1769 12.474 16.1769 13.0596 15.5926L16.95 11.71C17.34 11.32 17.34 10.68 16.95 10.29C16.56 9.89999 15.93 9.89999 15.54 10.29L14.5742 11.2558C14.0398 11.7902 13.5677 12.3835 13.1669 13.0242L12.9517 13.3684L12.746 13.1613C12.9146 12.4276 13 11.6763 13 10.9219V4C13 3.45 12.55 3 12 3ZM7 19C6.44772 19 6 19.4477 6 20C6 20.5523 6.44772 21 7 21H17C17.5523 21 18 20.5523 18 20C18 19.4477 17.5523 19 17 19H7Z" fill="currentColor" fill-opacity="0.85"></path></svg></a><img src="https://pictures.s3.yandex.net:443/resources/551403320_dfdcf9fc3b_1661350763.jpg" alt="image" crossorigin="anonymous" class="image image_expandable"></div></div><div class="paragraph">Чтобы эксперимент получил право на жизнь, нужно защитить его перед руководителем компании. Для защиты необходимо презентовать так называемый PoC (Proof of Concept, Проверка концепции) — продемонстрировать, что такой проект практически осуществим. Вам поручено разработать демонстрационную версию поиска изображений по запросу.</div><div class="paragraph">Для демонстрационной версии нужно выбрать лучшую  модель, которая получит векторное представление изображения, векторное представление текста, а на выходе выдаст число от 0 до 1 — и покажет, насколько текст и картинка подходят друг другу. </div><div class="paragraph">На основе лучшей модели можно будет собрать предварительную версию продукта, которую вы покажете руководителю компании.</div><h2><strong>Юридические ограничения</strong></h2><div class="paragraph">В некоторых странах, где работает компания With Sense, действуют ограничения по обработке изображений: поисковым сервисам и сервисам, предоставляющим возможность поиска, запрещено без разрешения родителей или законных представителей предоставлять любую информацию, в том числе, но не исключительно, текстов, изображений, видео и аудио, содержащие описание, изображение или запись голоса детей. Ребёнком считается любой человек, не достигший 16-ти лет.</div><div class="paragraph">В вашем сервисе строго следуют законам стран, в которых работают. Поэтому при попытке посмотреть изображения, запрещённые законодательством, вместо картинок показывается дисклеймер:</div><div class="paragraph">⎢ This image is unavailable in your country in compliance with local laws.</div><div class="paragraph">Однако у вас в PoC нет возможности воспользоваться данным функционалом. Поэтому необходимо очистить данные от проблемного контента. Во время тестирования модели при появлении в запросе “вредного” контента должен отображаться дисклеймер. </div><h2><strong>Описание данных</strong></h2><div class="paragraph">В файле <code class="code-inline code-inline_theme_light"><svg class="code-inline__check-icon" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.6805 3.76721C14.0852 4.14301 14.1086 4.77574 13.7328 5.18046L7.23281 12.1805C7.0401 12.388 6.76842 12.5041 6.48524 12.4999C6.20206 12.4957 5.93393 12.3716 5.74744 12.1585L2.24744 8.15851C1.88375 7.74287 1.92587 7.11111 2.34151 6.74743C2.75715 6.38375 3.38891 6.42586 3.75259 6.8415L6.52208 10.0066L12.2672 3.81955C12.643 3.41484 13.2758 3.39141 13.6805 3.76721Z" fill="currentColor" fill-opacity="0.85"></path></svg><span class="code-inline__content">train_dataset.csv</span></code> находится информация, необходимая для обучения: имя файла изображения, идентификатор описания и текст описания. Для одной картинки может быть доступно до 5 описаний. Идентификатор описания имеет формат <code class="code-inline code-inline_theme_light"><svg class="code-inline__check-icon" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.6805 3.76721C14.0852 4.14301 14.1086 4.77574 13.7328 5.18046L7.23281 12.1805C7.0401 12.388 6.76842 12.5041 6.48524 12.4999C6.20206 12.4957 5.93393 12.3716 5.74744 12.1585L2.24744 8.15851C1.88375 7.74287 1.92587 7.11111 2.34151 6.74743C2.75715 6.38375 3.38891 6.42586 3.75259 6.8415L6.52208 10.0066L12.2672 3.81955C12.643 3.41484 13.2758 3.39141 13.6805 3.76721Z" fill="currentColor" fill-opacity="0.85"></path></svg><span class="code-inline__content">&lt;имя файла изображения&gt;#&lt;порядковый номер описания&gt;</span></code>.</div><div class="paragraph">В папке <code class="code-inline code-inline_theme_light"><svg class="code-inline__check-icon" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.6805 3.76721C14.0852 4.14301 14.1086 4.77574 13.7328 5.18046L7.23281 12.1805C7.0401 12.388 6.76842 12.5041 6.48524 12.4999C6.20206 12.4957 5.93393 12.3716 5.74744 12.1585L2.24744 8.15851C1.88375 7.74287 1.92587 7.11111 2.34151 6.74743C2.75715 6.38375 3.38891 6.42586 3.75259 6.8415L6.52208 10.0066L12.2672 3.81955C12.643 3.41484 13.2758 3.39141 13.6805 3.76721Z" fill="currentColor" fill-opacity="0.85"></path></svg><span class="code-inline__content">train_images</span></code> содержатся изображения для тренировки модели.</div><div class="paragraph">В файле <code class="code-inline code-inline_theme_light"><svg class="code-inline__check-icon" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.6805 3.76721C14.0852 4.14301 14.1086 4.77574 13.7328 5.18046L7.23281 12.1805C7.0401 12.388 6.76842 12.5041 6.48524 12.4999C6.20206 12.4957 5.93393 12.3716 5.74744 12.1585L2.24744 8.15851C1.88375 7.74287 1.92587 7.11111 2.34151 6.74743C2.75715 6.38375 3.38891 6.42586 3.75259 6.8415L6.52208 10.0066L12.2672 3.81955C12.643 3.41484 13.2758 3.39141 13.6805 3.76721Z" fill="currentColor" fill-opacity="0.85"></path></svg><span class="code-inline__content">CrowdAnnotations.tsv</span></code>  — данные по соответствию изображения и описания, полученные с помощью краудсорсинга. Номера колонок и соответствующий тип данных:</div><ol start="1"><li>Имя файла изображения.</li><li>Идентификатор описания.</li><li>Доля людей, подтвердивших, что описание соответствует изображению.</li><li>Количество человек, подтвердивших, что описание соответствует изображению.</li><li>Количество человек, подтвердивших, что описание не соответствует изображению.</li></ol><div class="paragraph">В файле <code class="code-inline code-inline_theme_light"><svg class="code-inline__check-icon" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.6805 3.76721C14.0852 4.14301 14.1086 4.77574 13.7328 5.18046L7.23281 12.1805C7.0401 12.388 6.76842 12.5041 6.48524 12.4999C6.20206 12.4957 5.93393 12.3716 5.74744 12.1585L2.24744 8.15851C1.88375 7.74287 1.92587 7.11111 2.34151 6.74743C2.75715 6.38375 3.38891 6.42586 3.75259 6.8415L6.52208 10.0066L12.2672 3.81955C12.643 3.41484 13.2758 3.39141 13.6805 3.76721Z" fill="currentColor" fill-opacity="0.85"></path></svg><span class="code-inline__content">ExpertAnnotations.tsv</span></code>  — данные по соответствию изображения и описания, полученные в результате опроса экспертов. Номера колонок и соответствующий тип данных:</div><ol start="1"><li>Имя файла изображения.</li><li>Идентификатор описания.</li></ol><div class="paragraph">3, 4, 5 — оценки трёх экспертов. </div><div class="paragraph">Эксперты ставят оценки по шкале от 1 до 4, где 1 — изображение и запрос совершенно не соответствуют друг другу, 2 — запрос содержит элементы описания изображения, но в целом запрос тексту не соответствует, 3 — запрос и текст соответствуют с точностью до некоторых деталей, 4 — запрос и текст соответствуют полностью.      </div><div class="paragraph">В файле <code class="code-inline code-inline_theme_light"><svg class="code-inline__check-icon" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.6805 3.76721C14.0852 4.14301 14.1086 4.77574 13.7328 5.18046L7.23281 12.1805C7.0401 12.388 6.76842 12.5041 6.48524 12.4999C6.20206 12.4957 5.93393 12.3716 5.74744 12.1585L2.24744 8.15851C1.88375 7.74287 1.92587 7.11111 2.34151 6.74743C2.75715 6.38375 3.38891 6.42586 3.75259 6.8415L6.52208 10.0066L12.2672 3.81955C12.643 3.41484 13.2758 3.39141 13.6805 3.76721Z" fill="currentColor" fill-opacity="0.85"></path></svg><span class="code-inline__content">test_queries.csv</span></code> находится информация, необходимая для тестирования: идентификатор запроса, текст запроса и релевантное изображение. Для одной картинки может быть доступно до 5 описаний. Идентификатор описания имеет формат <code class="code-inline code-inline_theme_light"><svg class="code-inline__check-icon" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.6805 3.76721C14.0852 4.14301 14.1086 4.77574 13.7328 5.18046L7.23281 12.1805C7.0401 12.388 6.76842 12.5041 6.48524 12.4999C6.20206 12.4957 5.93393 12.3716 5.74744 12.1585L2.24744 8.15851C1.88375 7.74287 1.92587 7.11111 2.34151 6.74743C2.75715 6.38375 3.38891 6.42586 3.75259 6.8415L6.52208 10.0066L12.2672 3.81955C12.643 3.41484 13.2758 3.39141 13.6805 3.76721Z" fill="currentColor" fill-opacity="0.85"></path></svg><span class="code-inline__content">&lt;имя файла изображения&gt;#&lt;порядковый номер описания&gt;</span></code>.</div><div class="paragraph">В папке <code class="code-inline code-inline_theme_light"><svg class="code-inline__check-icon" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.6805 3.76721C14.0852 4.14301 14.1086 4.77574 13.7328 5.18046L7.23281 12.1805C7.0401 12.388 6.76842 12.5041 6.48524 12.4999C6.20206 12.4957 5.93393 12.3716 5.74744 12.1585L2.24744 8.15851C1.88375 7.74287 1.92587 7.11111 2.34151 6.74743C2.75715 6.38375 3.38891 6.42586 3.75259 6.8415L6.52208 10.0066L12.2672 3.81955C12.643 3.41484 13.2758 3.39141 13.6805 3.76721Z" fill="currentColor" fill-opacity="0.85"></path></svg><span class="code-inline__content">test_images</span></code> содержатся изображения для тестирования модели.</div><div class="paragraph">При решении задачи используйте только один фреймворк  Pytorch или Keras.</div><h2><strong>Инструкция по выполнению проекта</strong></h2><h3>Шаг 1. Загрузите данные и проведите исследовательский анализ данных</h3><div class="paragraph"><a href="https://code.s3.yandex.net/datasets/dsplus_integrated_project_4.zip" target="_blank">Скачайте</a>  и откройте файлы с данными. Проверьте данные и откорректируйте их, если потребуется.</div><h3>Шаг 2. Подготовьте данные к обучению модели</h3><ol start="1"><li>Создайте список слов которые, по вашему мнению, могут попадать под юридические ограничения.</li><li>Исключите из обучающего датасета пары, которые, исходя из подготовленного вами списка слов, могут попадать под юридические ограничения.</li><li>Сделайте векторизацию текстового описания одним из следующих методов:
 <ul><li>TF-IDF;</li><li>BERT;</li><li>word2vec.</li></ul></li><li>Сделайте  векторизацию изображений с использованием модели ResNet50 из библиотеки Keras или PyTorch.</li><li>Дайте описание получившихся пар векторов с точки зрения их размерностей.</li></ol><h3>Шаг 3. Обучите модель</h3><ol start="1"><li>Создайте модель, которая покажет близость двух векторов. Модель должна принимать на вход конкатенированный вектор, состоящий из векторов описания и изображений, и предсказывать итоговую оценку экспертов.</li><li>Выберите метрику, по которой вы будете сравнивать точность различных моделей.</li><li>Обучите несколько моделей и подберите их гиперпараметры. В качестве моделей обязательно нужно рассмотреть:
 1. Линейную регрессию;
 2. Полносвязные нейронные сети.</li></ol><h3>Шаг 4.  Тестирование модели и демонстрация ее работы</h3><ol start="1"><li>Проведите тестирование лучшей модели на тестовых данных.</li><li>Напишите функцию, которая принимает на вход текстовое описание, делает его векторизацию и возвращает картинку с максимальным значением метрики.</li></ol><div class="quiz-task" style="--quiz-task-background: var(--color-background-alternate); --quiz-task-color: var(--color-content-primary);"><div class="Markdown base-markdown base-markdown_with-gallery base-markdown markdown markdown_size_normal markdown_type_theory quiz-task__content">
<div class="paragraph">💡 Если запрос ведёт на юридически вредный контент, функция должна выводить дисклеймер.</div></div></div>
<ol start="3"><li>С помощью написанной вами функции протестируйте работу модели на нескольких текстовых описаниях: проверьте, какие картинки она выдает при различных текстовых запросах.</li></ol><h3>Шаг 5. Сделайте общий вывод по работе</h3><div class="paragraph">Опишите модель, которая лучше всего справляется с задачей сравнения сходства картинки и текста. Опишите, какие ошибки допускает модель во время поиска картинки по её текстовому описанию. Оцените, насколько проект по созданию сервиса поиска фотографий по текстовому описанию практически осуществим.</div><h1><strong>Оформление</strong></h1><div class="paragraph">Выполните задание в&nbsp;Jupyter Notebook. Заполните программный код в ячейках типа&nbsp;<em>code,</em>&nbsp;текстовые пояснения — в ячейках типа&nbsp;<em>markdown</em>. Примените форматирование и заголовки.</div><div class="paragraph">Для проекта вам могут потребоваться серьёзные мощности, например, GPU. В Яндекс.Практикуме существуют ограничения по выделяемым ресурсам в JupyterHub. Поэтому необходимо выполнять проект в Kaggle, Google Colab, DeepNote, Yandex Data Sphere или локально.</div></div></section></section>
